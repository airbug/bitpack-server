{
    "AWSTemplateFormatVersion": "2010-09-09",
    "recipeDNSRecords" : {
        "Type" : "AWS::Route53::RecordSetGroup",
        "Properties" : {
            "HostedZoneName" : "gulprecipe.com.",
            "Comment" : "DNS records for gulp-recipe.",
            "RecordSets": [
                {
                    "Name": "gulprecipe.com.",
                    "Type": "A",
                    "TTL": "900",
                    "ResourceRecords": [
                        "192.168.0.1",
                        "192.168.0.2"
                    ]
                },
                {
                    "Name": "edge.gulprecipe.com.",
                    "Type": "CNAME",
                    "TTL": "900",
                    "ResourceRecords": [
                        "TODO Figure out how to get cloudfront url"
                    ]
                }
            ]
        }
    },
    "Resources" : {
        "recipeS3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AccessControl": "PublicRead",
                "BucketName": "gulp-recipe",
                "LoggingConfiguration": {
                    "DestinationBucketName": {"Ref" : "logsBucket"},
                    "LogFilePrefix": "logs/gulp-recipe/S3"
                }
            },
            "DeletionPolicy": "Retain"
        },
        "logsBucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "AccessControl": "LogDeliveryWrite",
                "BucketName": "gulp-recipe-logs"
            }
        }
    },
    "recipeCloudfrontDistribution" : {
        "Type" : "AWS::CloudFront::Distribution",
        "Properties" : {
            "DistributionConfig" : {
                "Origins" : [ {
                    "DomainName": "gulp-recipe.s3.amazonaws.com",
                    "Id" : "recipeS3Origin"
                }],
                "Enabled" : "true",
                "Comment" : "gulp-recipe cloudfront",
                "Logging" : {
                    "IncludeCookies" : "false",
                    "Bucket" : "gulp-recipe-logs.s3.amazonaws.com",
                    "Prefix" : "logs/gulp-recipe/cloudfront"
                },
                "DefaultCacheBehavior" : {
                    "AllowedMethods" : [ "DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT" ],
                    "TargetOriginId" : "recipeS3Origin",
                    "ForwardedValues" : {
                        "QueryString" : "false",
                        "Cookies" : { "Forward" : "none" }
                    },
                    "ViewerProtocolPolicy" : "redirect-to-https"
                },
               "ViewerCertificate" : {
                   "IamCertificateId": "",
                   "SslSupportMethod": "sni-only"
               }
            }
        }
    },
    "recipeLoadBalancer" : {
        "Type" : "AWS::ElasticLoadBalancing::LoadBalancer",
        "Properties" : {
            "AvailabilityZones" : [ "us-east-1a" ],
            "Listeners" : [ {
                "LoadBalancerPort" : "80",
                "InstancePort" : "80",
                "Protocol" : "HTTP"
            } ],
            "HealthCheck" : {
            "Target" : "HTTP:80/",
                "HealthyThreshold" : "3",
                "UnhealthyThreshold" : "5",
                "Interval" : "30",
                "Timeout" : "5"
            }
        }
    }
}